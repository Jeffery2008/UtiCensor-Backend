# 路由器概览功能

## 概述

路由器概览功能提供了一个直观的界面来显示当前系统中的路由器数量、区域分布以及每个路由器下的设备情况。这个功能与设备自动分配功能完全集成，确保新设备能够正确归属到相应的路由器区域。

## 功能特性

### 📊 统计概览
- **路由器总数**: 显示系统中配置的所有路由器数量
- **区域总数**: 显示已配置的路由器区域数量
- **活跃路由器**: 显示当前活跃的路由器数量
- **总设备数**: 显示所有路由器下的设备总数

### 📋 详细列表
- **区域名称**: 路由器区域的名称
- **路由器名称**: 具体的路由器名称
- **标识符**: 路由器的唯一标识符
- **设备数量**: 该路由器下的设备总数
- **活跃设备**: 该路由器下的活跃设备数量
- **状态**: 路由器状态（活跃/禁用/无设备）
- **创建时间**: 路由器区域创建的时间

### 🔄 实时更新
- 支持手动刷新数据
- 显示加载状态
- 错误处理和用户反馈

## 界面展示

### 统计卡片
```
┌─────────────────┬─────────────────┬─────────────────┬─────────────────┐
│   路由器总数     │    区域总数      │   活跃路由器     │    总设备数      │
│       3         │       3         │       3         │      25         │
│   3 活跃 / 0 禁用 │  已配置的路由器区域 │    100% 活跃率    │  所有路由器下的设备 │
└─────────────────┴─────────────────┴─────────────────┴─────────────────┘
```

### 详细表格
```
┌──────────────┬──────────────┬─────────────────────┬──────────┬──────────┬──────────┬────────────┐
│   区域名称    │  路由器名称   │      标识符         │ 设备数量  │ 活跃设备  │   状态    │  创建时间   │
├──────────────┼──────────────┼─────────────────────┼──────────┼──────────┼──────────┼────────────┤
│   默认区域    │  默认路由器   │      default        │    5     │    3     │   活跃    │  2024-01-01 │
│ 办公室路由器  │ 办公室路由器  │ router_56d5dc819521 │   12     │   10     │   活跃    │  2024-01-15 │
│  家庭路由器   │  家庭路由器   │   router_home_001   │    8     │    6     │   活跃    │  2024-01-20 │
└──────────────┴──────────────┴─────────────────────┴──────────┴──────────┴──────────┴────────────┘
```

## 技术实现

### 前端组件
- **RouterOverview.jsx**: 主要的概览组件
- 使用React Hooks管理状态
- 响应式设计，支持移动端
- 实时数据刷新功能

### 后端API
- **GET /router-zones**: 获取所有路由器区域
- **GET /devices/stats**: 获取设备统计信息
- 集成设备自动分配逻辑

### 数据流程
1. 前端请求路由器区域数据
2. 后端查询数据库获取区域信息
3. 同时获取设备统计信息
4. 合并数据并返回给前端
5. 前端渲染统计卡片和详细表格

## 使用方式

### 1. 访问路由器概览
- 在侧边栏导航中点击"Router Overview"
- 或直接访问 `/router-overview` 路径

### 2. 查看统计信息
- 页面顶部显示4个统计卡片
- 实时显示路由器总数、活跃率等信息

### 3. 查看详细列表
- 表格显示所有路由器区域的详细信息
- 包含设备数量、活跃状态等

### 4. 刷新数据
- 点击"刷新"按钮更新数据
- 支持实时监控路由器状态

## 配置要求

### 路由器映射配置
在 `config/app.php` 中配置路由器映射：

```php
'router_identifier_mapping' => [
    '192.168.1.1' => 'router_office_001',
    '192.168.2.1' => 'router_home_001',
    '10.0.0.1' => 'router_default',
],
```

### 自动创建设置
```php
'netify' => [
    'auto_create_zones' => true,      // 自动创建路由器区域
    'auto_assign_devices_to_router' => true,  // 自动分配设备到路由器
],
```

## 故障排除

### 没有显示路由器数据
1. 检查路由器映射配置是否正确
2. 确认路由器脚本正在发送数据
3. 验证数据库连接是否正常

### 设备数量不准确
1. 检查设备自动分配功能是否正常工作
2. 确认设备是否正确分配到路由器区域
3. 运行设备统计脚本验证数据

### 路由器状态显示错误
1. 检查路由器区域的状态设置
2. 确认路由器是否正在发送数据
3. 验证网络连接是否正常

## 相关功能

### 设备自动分配
- 新设备自动分配到发送请求的路由器区域
- 避免设备出现在"未知区域"
- 支持设备重新分配

### 路由器映射
- 配置IP地址到路由器标识符的映射
- 支持自动创建路由器区域
- 提供测试和验证功能

### 设备统计
- 显示设备分布情况
- 统计活跃和非活跃设备
- 提供设备类型分析

## 最佳实践

1. **定期检查**: 定期查看路由器概览，确保所有路由器正常工作
2. **配置映射**: 为每个路由器配置明确的标识符映射
3. **监控状态**: 关注路由器活跃率和设备分布情况
4. **及时处理**: 发现异常状态时及时处理

## 未来扩展

- 添加路由器性能监控
- 支持路由器分组管理
- 增加历史数据统计
- 提供告警和通知功能 